function [backwindow] = PORClinkF(mainsrc, window, backwindow,trialprop, trial_con, image_in, ape_only_im,fixrect,grayblack)%% PORClinkF.m%% Function for Face Perception Ape->Human morphing experiments% generates linking display for Ape/Human images..% Called by: PORCpractice4a.m PORCquest4a.m%% Variables:%%% Written by Ethan Duwell% July, 2022%% This script began as Adam Greenberg's PORClinkL4a.m. Ethan Duwell% initially modified it to display shapes filled with textures % (instead of shapes of variable luminance)  %% This version is intended for the Facemorph stimuli used in Priyanka's% face/attn experiments...%% First some basic setup% Get the screen numbersscreens = Screen('Screens');% Draw to the external screen if avaliablescreenNumber = max(screens);% Define black and whitewhite = WhiteIndex(screenNumber);black = BlackIndex(screenNumber);grey = white / 2;inc = white - grey;% Set up alpha-blending for smooth (anti-aliased) linesScreen('BlendFunction', backwindow, 'GL_SRC_ALPHA', 'GL_ONE_MINUS_SRC_ALPHA');%% Load in the image% if trialprop is "V" (ie an ape-only trial..) swap image in for the% "ape-only" image..if trialprop{1} == trial_con(1)    image_in = ape_only_im;end% if trialprop is "H" (ie an ape+human trial..) do nothing.. image_in % is already the quest selected image..if trialprop{1} == trial_con(2)    % Do Nothing (image in is already the quest selected image.. (and can't    % ,by design, be the "ape only" one)end% Get the dimensions of the offscreen window as an image% Screen('FillRect', backwindow, grey);  % black out the offscreen window%% Draw the shapes/images to the final output offscreen window% grey out the offscreen window%Screen('FillRect', backwindow, grey); % draw fixation box on offscreen window% Screen('DrawLines', backwindow_fix, fixlines, penW, chargray);%Screen('FillRect', backwindow, grayblack, fixrect); % EJD COMMENTED OUT%FIXATION PT CALL.. IMAGES ALREADY HAVE FIX PT..% draw the imageimage_tex = Screen('MakeTexture', window, image_in);Screen('DrawTexture', backwindow, image_tex)end